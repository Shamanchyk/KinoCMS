{"version":3,"file":"js/114.b0080e1b.js","mappings":"ybACSA,MAAM,a,GACT,OAA0B,OAArBA,MAAM,UAAQ,S,GAAnB,G,aAIE,OAA2B,UAAvB,sBAAkB,G,GACjBA,MAAM,c,GAEEA,MAAM,gB,mDAOX,OAAuC,OAAlCC,IAAA,EAA2BC,IAAI,I,YACpC,OAAe,SAAZ,YAAQ,G,6FAhBM,EAAO,U,WAApC,QAEM,MAFN,EAEM,K,gBACiB,IAAZ,EAAAC,U,WAAX,QAiBM,UAhBJ,OAeM,YAdJ,GACA,OAYM,MAZN,EAYM,G,aAXF,QAMM,mBANkC,EAAAC,SAAVC,K,WAA9B,QAMM,OANDL,MAAM,YAAuCM,IAAKD,EAAOE,I,EAC1D,OAGM,MAHN,EAGM,CAF4CF,EAAY,Q,WAA5D,QAA8F,O,MAAxFJ,IAAKI,EAAOG,MAAOR,MAAM,WAAgC,QAAK,GAAE,EAAAS,YAAYJ,EAAOE,K,2BACzDF,EAAOG,OAAU,EAAAJ,QAAQM,OAAS,I,WAAlE,QAA8G,Q,MAAxGV,MAAM,cAA0D,QAAK,GAAE,EAAAW,aAAaN,EAAOE,KAAK,IAAC,O,kBAEzG,OAAyD,KAArD,QAAK,GAAE,EAAAE,YAAYJ,EAAOE,M,QAAQF,EAAOO,OAAK,U,OAEtD,QAGc,GAHDC,GAAG,eAAeb,MAAM,c,mBACjC,IAAuC,CAAvC,EACA,K,iEAehB,GAEIc,QACA,MAAMC,GAAK,UACLC,GAAY,QAAMD,EAAI,WAEtBZ,GAAU,SAAI,GACdC,GAAU,QAAI,IAsBpB,OApBA,SAAU,MACR,QAAQY,GAAYC,IAClB,MAAMC,EAAaD,EAASE,MACtBC,EAAc,GAEpB,IAAK,MAAMd,KAAOY,EAChBE,EAAYC,KAAK,CACbd,GAAIW,EAAWZ,GAAKC,GACpBK,MAAOM,EAAWZ,GAAKgB,SACvBd,MAAOU,EAAWZ,GAAKiB,aAI7BnB,EAAQoB,MAAQJ,EAEhBK,YAAW,KACTtB,EAAQqB,OAAQ,CAAK,GACpB,IAAK,GACR,IAEG,CAAEpB,UAASD,UACpB,EAGEuB,OACI,MAAM,CAEN,CACJ,EAGAC,QAAS,CACPlB,YAAYF,GACVqB,KAAKC,QAAQR,KAAK,CAAES,KAAM,SAAUC,OAAQ,CAAExB,OAChD,EACAyB,WAAWzB,GACT,MAAMQ,GAAK,UACLkB,EAAS,WAAW1B,IACpB2B,GAAU,QAAMnB,EAAIkB,GAE1B,GAAGL,KAAKxB,QAAQM,OAAS,EAAE,EAE3B,QAAOwB,GACJC,MAAK,KACJC,QAAQC,IAAI,mDAAmD,IAEhEC,OAAOC,IACNH,QAAQC,IAAI,+CAAgDE,EAAM,IAGpE,MAAMC,GAAU,UACVC,EAAW,WAAWlC,gBAGrBmC,GAAgB,QAAQF,EAASC,IAEtC,QAAQC,GAAeP,MAAMQ,IAC7BA,EAAOC,MAAMC,SAASC,KAEpB,QAAaA,GAAUX,MAAK,KAC1BC,QAAQC,IAAI,cAAcS,EAAShB,8BAA8B,IAChEQ,OAAOC,IACRH,QAAQC,IAAI,4CAA4CS,EAAShB,QAASS,EAAM,GAChF,GACF,IAIJ,MAAMQ,GAAmB,QAAQP,EAAS,WAAWjC,iBACrD,QAAawC,EACf,CAEF,I,SC1GN,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://kinocms/./src/views/Admin/TheatresVue.vue","webpack://kinocms/./src/views/Admin/TheatresVue.vue?2bbf"],"sourcesContent":["<template>\r\n    <div class=\"preloader\" v-if=\"loading\">\r\n      <div class=\"loader\"></div>\r\n    </div>\r\n    <div v-if=\"loading === false\">\r\n      <div> \r\n        <h2>Список кінотеатрів</h2>\r\n        <div class=\"films-main\">\r\n            <div class=\"film-main\" v-for=\"cinema in cinemas\" :key=\"cinema.id\">\r\n                <div class=\"image-delete\">\r\n                  <img :src=\"cinema.image\" class=\"imgInput\" v-if=\"cinema.image\" @click=\"cinemaClick(cinema.id)\">\r\n                  <span class=\"deleteSpan2\" v-if=\"cinema.image  && cinemas.length > 1\" @click=\"deleteCinema(cinema.id)\">x</span>\r\n                </div>\r\n                <p @click=\"cinemaClick(cinema.id)\">{{ cinema.title }}</p>\r\n            </div>\r\n            <router-link to=\"/pageTheatre\" class=\"add-cinema\">\r\n                <img src=\"@/assets/img/add.png\" alt=\"\">\r\n                <p>Добавити</p>\r\n            </router-link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n</template>\r\n\r\n\r\n<script>    \r\n\r\nimport { ref, onMounted } from 'vue';\r\nimport { getDatabase, ref as dbRef, onValue, remove } from 'firebase/database';\r\nimport { getStorage, ref as storRef, deleteObject, listAll } from \"firebase/storage\";\r\n\r\nexport default {\r\n\r\n    setup() {\r\n    const db = getDatabase()\r\n    const moviesRef = dbRef(db, 'cinemas');\r\n\r\n    const loading = ref(true)\r\n    const cinemas = ref([]);\r\n\r\n    onMounted(() => {\r\n      onValue(moviesRef, (snapshot) => {\r\n        const moviesData = snapshot.val();\r\n        const moviesArray = [];\r\n\r\n        for (const key in moviesData) {\r\n          moviesArray.push({\r\n              id: moviesData[key].id,\r\n              title: moviesData[key].nameFilm,\r\n              image: moviesData[key].imageFirst,\r\n          });\r\n        } \r\n\r\n        cinemas.value = moviesArray;\r\n\r\n        setTimeout(() => {\r\n          loading.value = false;\r\n        }, 2000);\r\n      });\r\n    });\r\n    return { cinemas, loading };\r\n  },\r\n\r\n\r\n    data(){\r\n        return{\r\n\r\n        }\r\n    },\r\n\r\n\r\n    methods: {\r\n      cinemaClick(id) {\r\n        this.$router.push({ name: \"cinema\", params: { id } });\r\n      },\r\n      deleteFilm(id){\r\n        const db = getDatabase();\r\n        const pathDb = `cinemas/${id}`\r\n        const itemRef = dbRef(db, pathDb);\r\n\r\n        if(this.cinemas.length > 1){\r\n\r\n        remove(itemRef)\r\n          .then(() => {\r\n            console.log(\"Item successfully deleted from Realtime Database\");\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"Error deleting item from Realtime Database: \", error);\r\n          });\r\n        \r\n          const storage = getStorage();\r\n          const pathStor = `cinemas/${id}/galleryImgs`\r\n\r\n          // Видалення фотографій фільму\r\n           const filmPhotosRef = storRef(storage, pathStor);\r\n\r\n            listAll(filmPhotosRef).then((result) => {\r\n            result.items.forEach((imageRef) => {\r\n              // Видаляємо кожну фотографію\r\n              deleteObject(imageRef).then(() => {\r\n                console.log(`Фотографія ${imageRef.name} була успішно видалена!`);\r\n              }).catch((error) => {\r\n                console.log(`Сталася помилка при видаленні фотографії ${imageRef.name}:`, error);\r\n              });\r\n            });\r\n          });\r\n           \r\n          // // Видалення головної фотографії фільму\r\n          const filmMainPhotoRef = storRef(storage, `cinemas/${id}/imageFirst`);\r\n          deleteObject(filmMainPhotoRef);\r\n        }\r\n\r\n      },\r\n    },\r\n\r\n}\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n.films-main{\r\n    display: flex;\r\n    gap: 40px;\r\n    width: 92%;\r\n    margin: 30px auto 0;\r\n}\r\n.film-main{\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n    cursor: pointer;\r\n\r\n    img{\r\n        width: 250px;\r\n        height: 250px;\r\n        display: block;\r\n    }\r\n\r\n    p{\r\n        font-weight: 600;\r\n        font-size: 20px;\r\n        color: #515558;\r\n    }\r\n}\r\n.mt{\r\n  margin-top: 40px;\r\n}\r\n.deleteSpan2{\r\n  position: absolute;\r\n  top: -8px;\r\n  right: -8px;\r\n  border: 1px solid black;\r\n  background: white;\r\n  border-radius: 50%;\r\n  color: black;\r\n  width: 26px;\r\n  z-index: 2;\r\n}\r\n.image-delete{\r\n  position: relative;\r\n}\r\n    \r\n\r\n.preloader {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #333333;\r\n  opacity: 0.7;\r\n  z-index: 99999;\r\n}\r\n\r\n.loader {\r\n  border: 16px solid #333333;\r\n  border-top: 16px solid #3498db;\r\n  border-radius: 50%;\r\n  width: 120px;\r\n  height: 120px;\r\n  animation: spin 1s linear infinite;\r\n\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  margin-top: -60px;\r\n  margin-left: -60px;\r\n}\r\n@keyframes spin {\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.add-cinema{\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n\r\n    img{\r\n        width: 100px;\r\n        height: 100px;\r\n    }\r\n\r\n    p{\r\n        font-weight: 600;\r\n        font-size: 20px;\r\n        color: #515558;\r\n    }\r\n}\r\n\r\n</style>","import { render } from \"./TheatresVue.vue?vue&type=template&id=3f1d3cda\"\nimport script from \"./TheatresVue.vue?vue&type=script&lang=js\"\nexport * from \"./TheatresVue.vue?vue&type=script&lang=js\"\n\nimport \"./TheatresVue.vue?vue&type=style&index=0&id=3f1d3cda&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\MrBin\\\\Desktop\\\\Front\\\\Kino_CMS\\\\kinocms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","src","alt","loading","cinemas","cinema","key","id","image","cinemaClick","length","deleteCinema","title","to","setup","db","moviesRef","snapshot","moviesData","val","moviesArray","push","nameFilm","imageFirst","value","setTimeout","data","methods","this","$router","name","params","deleteFilm","pathDb","itemRef","then","console","log","catch","error","storage","pathStor","filmPhotosRef","result","items","forEach","imageRef","filmMainPhotoRef","__exports__","render"],"sourceRoot":""}