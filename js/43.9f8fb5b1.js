"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[43],{43:function(e,l,i){i.r(l),i.d(l,{default:function(){return ee}});var t=i(252),a=i(963),s=i(577);const r={class:"container"},n={class:"card card-primary"},m=(0,t._)("div",{class:"card-header"},[(0,t._)("h3",{class:"card-title"},"Інформація про фільм")],-1),o={class:"card-body"},c={class:"form-group"},d=(0,t._)("label",{for:"nameFilm"},"Назва фільма",-1),g={class:"form-group"},h=(0,t._)("label",{for:"description"},"Опис",-1),u={class:"file-input"},p=(0,t._)("label",{for:"holovnaImg"},"Головна картинка",-1),f={class:"image-delete_btn"},y={class:"image-delete"},k=["src"],F={class:"file-input"},I=(0,t._)("label",{for:"holovnaImg"},"Галерея картинок",-1),_={class:"image-delete_btn2"},b=["src"],w=["onClick"],v={class:"form-group"},D=(0,t._)("label",null,"Посилання на трейлер",-1),C={class:"form-group"},S=(0,t._)("label",null,"Тип фільма",-1),x={class:"form-main"},U=["onClick"],V=["onUpdate:modelValue","id"],$=["for"],q={class:"form-group"},T=(0,t._)("label",null,"Фільм",-1),R={class:"form-main"},H=["id","value"],M=["for"],E={class:"form-group"},G=(0,t._)("h5",null,"SEO блок:",-1),K=(0,t._)("label",null,"URL",-1),L={class:"form-group"},O=(0,t._)("label",null,"Title",-1),j={class:"form-group"},z=(0,t._)("label",null,"Keywords",-1),A={class:"form-group"},N=(0,t._)("label",null,"Description",-1),Y={key:0,class:"message"},J={class:"card-footer"};function P(e,l,i,P,X,Z){return(0,t.wg)(),(0,t.iD)("div",r,[(0,t._)("div",n,[m,(0,t._)("div",null,[(0,t._)("div",o,[(0,t._)("div",c,[d,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"nameFilm","onUpdate:modelValue":l[0]||(l[0]=e=>X.film.nameFilm=e),required:""},null,512),[[a.nr,X.film.nameFilm]])]),(0,t._)("div",g,[h,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"Текст","onUpdate:modelValue":l[1]||(l[1]=e=>X.film.description=e),required:""},null,512),[[a.nr,X.film.description]])]),(0,t._)("div",u,[p,null===X.film.imageFirst?((0,t.wg)(),(0,t.iD)("input",{key:0,type:"file",ref:"fileInput",class:"file-input__input",onChange:l[2]||(l[2]=(...e)=>Z.handleFileChange&&Z.handleFileChange(...e)),required:""},null,544)):(0,t.kq)("",!0),null===X.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:1,onClick:l[3]||(l[3]=(...e)=>Z.triggerFileInput&&Z.triggerFileInput(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",f,[(0,t._)("div",y,[X.film.imageFirst?((0,t.wg)(),(0,t.iD)("img",{key:0,src:X.film.imageFirst,class:"imgInput"},null,8,k)):(0,t.kq)("",!0)]),null!==X.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[4]||(l[4]=(...e)=>Z.deleteImageSrc&&Z.deleteImageSrc(...e)),class:"btn btn-block btn-default"},"Видалити")):(0,t.kq)("",!0)])]),(0,t._)("div",F,[I,(0,t._)("input",{type:"file",ref:"fileInput2",class:"file-input__input",onChange:l[5]||(l[5]=(...e)=>Z.handleFileChange2&&Z.handleFileChange2(...e)),multiple:""},null,544),X.galleryImages==[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[6]||(l[6]=(...e)=>Z.triggerFileInput2&&Z.triggerFileInput2(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",_,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.galleryImages,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"image-delete",key:l},[e?((0,t.wg)(),(0,t.iD)("img",{key:0,src:e.url,class:"imgInput"},null,8,b)):(0,t.kq)("",!0),e?((0,t.wg)(),(0,t.iD)("span",{key:1,class:"deleteSpan",onClick:e=>Z.deleteGalleryImg(l)},"x",8,w)):(0,t.kq)("",!0)])))),128)),X.galleryImages!=[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[7]||(l[7]=(...e)=>Z.triggerFileInput2&&Z.triggerFileInput2(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0)])]),(0,t._)("div",v,[D,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Введіть посилання на трейлер","onUpdate:modelValue":l[8]||(l[8]=e=>X.film.linkTrailer=e)},null,512),[[a.nr,X.film.linkTrailer]])]),(0,t._)("div",C,[S,(0,t._)("div",x,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.typeFilms,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:l,onClick:i=>Z.pushTypeFilm(e,l)},[(0,t.wy)((0,t._)("input",{class:"form-check-input","onUpdate:modelValue":l=>e.checked=l,type:"checkbox",id:e.type},null,8,V),[[a.e8,e.checked]]),(0,t._)("label",{class:"form-check-label",for:e.type},(0,s.zw)(e.type),9,$)],8,U)))),128))])]),(0,t._)("div",q,[T,(0,t._)("div",R,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.dataFilms,((e,i)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:i},[(0,t.wy)((0,t._)("input",{class:"form-check-input",type:"radio",id:e.name,name:"name",value:e.name,"onUpdate:modelValue":l[9]||(l[9]=e=>X.radioData=e)},null,8,H),[[a.G2,X.radioData]]),(0,t._)("label",{class:"form-check-label",for:e.name},(0,s.zw)(e.name),9,M)])))),128))])]),(0,t._)("div",E,[G,K,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"URL","onUpdate:modelValue":l[10]||(l[10]=e=>X.film.url=e)},null,512),[[a.nr,X.film.url]])]),(0,t._)("div",L,[O,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Title","onUpdate:modelValue":l[11]||(l[11]=e=>X.film.title=e)},null,512),[[a.nr,X.film.title]])]),(0,t._)("div",j,[z,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"word","onUpdate:modelValue":l[12]||(l[12]=e=>X.film.keywords=e)},null,512),[[a.nr,X.film.keywords]])]),(0,t._)("div",A,[N,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",placeholder:"Description","onUpdate:modelValue":l[13]||(l[13]=e=>X.film.descriptionSeo=e)},"\r\n            ",512),[[a.nr,X.film.descriptionSeo]])])]),X.showMessage?((0,t.wg)(),(0,t.iD)("div",Y,(0,s.zw)(X.message),1)):(0,t.kq)("",!0),(0,t._)("div",J,[(0,t._)("button",{onClick:l[14]||(l[14]=(...e)=>Z.updateFilm&&Z.updateFilm(...e)),class:"btn btn-primary",type:"submit"},"Оновити"),(0,t._)("button",{class:"btn btn-primary",onClick:l[15]||(l[15]=(...e)=>Z.resetFilm&&Z.resetFilm(...e)),type:"button"},"Повернути базову версію")])])])])}var X=i(355),Z=i(650),B={data(){return{film:{},originalFilm:{},filmId:null,typeFilms:[{type:"2D",checked:!1},{type:"3D",checked:!1},{type:"IMAX",checked:!1}],dataFilms:[{name:"Вже вийшов",checked:!1},{name:"Скоро вийде",checked:!1}],fileImgSrc:null,message:"Фільм збережено!",showMessage:!1,fileGalleryImg:[],imageSrc2:null,galleryImages:[],typeFilm:[],radioData:"",loaded:!1}},async mounted(){await this.getFilm()},methods:{async getFilm(){const e=(0,X.N8)();this.filmId=this.$route.params.id;const l=(0,X.iH)(e,"films/"+this.filmId);await new Promise((e=>{(0,X.jM)(l,(l=>{l.exists()?(this.film=l.val(),this.originalFilm=l.val(),"undefined"!==typeof this.film.galleryImages&&Array.isArray(this.film.galleryImages)?this.galleryImages=this.film.galleryImages:this.galleryImages=[],console.log(this.galleryImages)):console.log("Фільм не знайдено"),e()}))})),this.updateChecked(),this.updateRadio()},updateChecked(){this.typeFilms.forEach((e=>{this.film.typeFilm.includes(e.type)&&(e.checked=!0,!0!==e.checked||this.typeFilm.includes(e.type)||this.typeFilm.push(e.type))}))},pushTypeFilm(e,l){this.typeFilm.includes(e.type)||!1!==e.checked?this.typeFilm.includes(e.type)&&!0===e.checked&&(this.typeFilm.forEach((function(i,t,a){e.type===i&&(l=t)})),this.typeFilm.splice(l,1)):(this.typeFilm.push(e.type),console.log(this.typeFilm))},updateRadio(){this.dataFilms.forEach((e=>{this.film.radioData.includes(e.name)&&(e.checked=!0,!0===e.checked&&(this.radioData=e.name))}))},handleFileChange(e){this.fileImgSrc=e.target.files[0],this.film.imageFirst=URL.createObjectURL(this.fileImgSrc)},triggerFileInput(){this.$refs.fileInput.click()},deleteImageSrc(){this.film.imageFirst=null},handleFileChange2(e){this.fileGalleryImg=[...e.target.files];for(let l of this.fileGalleryImg){const e=URL.createObjectURL(l);this.galleryImages.push({url:e})}},triggerFileInput2(){this.$refs.fileInput2.click()},async deleteGalleryImg(e){let l;this.galleryImages.forEach(((i,t)=>{t===e&&(l=i)})),this.galleryImages.splice(e,1);const i=(0,Z.cF)(),t=(0,Z.iH)(i,`films/${this.filmId}/galleryImgs/${l.name}`);try{await(0,Z.oq)(t),console.log(`Файл з індексом ${l.name} успішно видалено`)}catch(n){console.error(`Помилка видалення файлу з індексом ${l.name}:`,n)}const a=(0,X.N8)(),s=`films/${this.filmId}/galleryImages/${e}`,r=(0,X.iH)(a,s);await(0,X.Od)(r).then((()=>{console.log("Item successfully deleted from Realtime Database")})).catch((e=>{console.log("Error deleting item from Realtime Database: ",e)}))},async updateFilm(){const e=(0,X.N8)(),l=(0,Z.cF)(),i=`films/${this.filmId}`,t=(this.filmId,(0,X.iH)(e,i));(0,X.Vx)(t,{id:t.key,nameFilm:this.film.nameFilm,description:this.film.description,linkTrailer:this.film.linkTrailer,typeFilm:this.typeFilm,radioData:this.radioData,url:this.film.url,title:this.film.title,keywords:this.film.keywords,descriptionSeo:this.film.descriptionSeo}),this.fileImgSrc?(0,X.Vx)(t,{imageFirst:this.fileImgSrc}):(0,X.Vx)(t,{imageFirst:this.film.imageFirst});const a=await(0,X.U2)(t),s=a.val()&&a.val().galleryImages||[],r=[...s];if(await Promise.all(this.fileGalleryImg.map((async e=>{const i="image-"+Date.now()+Math.floor(1e3*Math.random()),a=(0,Z.iH)(l,`films/${t.key}/galleryImgs/${i}`);await(0,Z.KV)(a,e);const s=await(0,Z.Jt)(a);r.push({name:i,url:s})}))),(0,X.Vx)(t,{galleryImages:r}),this.fileImgSrc){const e=(0,Z.iH)(l,`films/${t.key}/imageFirst`);(0,Z.KV)(e,this.fileImgSrc).then((e=>{(0,Z.Jt)(e.ref).then((e=>{(0,X.Vx)(t,{imageFirst:e})}))}))}this.showMessage=!0,setTimeout((()=>{this.showMessage=!1}),3e3),this.$router.push("/films")},resetFilm(){this.film.description=this.originalFilm.description,this.film.descriptionSeo=this.originalFilm.descriptionSeo,this.galleryImages=this.originalFilm.galleryImages,this.film.imageFirst=this.originalFilm.imageFirst,this.film.keywords=this.originalFilm.keywords,this.film.linkTrailer=this.originalFilm.linkTrailer,this.film.nameFilm=this.originalFilm.nameFilm,this.radioData=this.originalFilm.radioData,this.film.title=this.originalFilm.title,this.typeFilms.forEach((e=>{e.checked=this.originalFilm.typeFilm.includes(e.type)})),this.film.url=this.originalFilm.url}}},Q=i(744);const W=(0,Q.Z)(B,[["render",P]]);var ee=W}}]);
//# sourceMappingURL=43.9f8fb5b1.js.map