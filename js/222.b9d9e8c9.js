"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[222],{222:function(i,e,l){l.r(e),l.d(e,{default:function(){return ii}});var t=l(252),s=l(963),a=l(577);const r={class:"container"},n={class:"card card-primary"},m=(0,t._)("div",{class:"card-header"},[(0,t._)("h3",{class:"card-title"},"Інформація про фільм")],-1),o={class:"card-body"},c={class:"form-group"},d=(0,t._)("label",{for:"nameFilm"},"Назва фільма",-1),h={class:"form-group"},g=(0,t._)("label",{for:"description"},"Опис",-1),p={class:"file-input"},u=(0,t._)("label",{for:"holovnaImg"},"Головна картинка",-1),f={class:"image-delete_btn"},y={class:"image-delete"},F=["src"],k={class:"file-input"},_=(0,t._)("label",{for:"holovnaImg"},"Галерея картинок",-1),b={class:"image-delete_btn2"},I=["src"],w=["onClick"],v={class:"form-group"},D=(0,t._)("label",null,"Посилання на трейлер",-1),C={class:"form-group"},S=(0,t._)("label",null,"Тип фільма",-1),x={class:"form-main"},V=["onClick"],U=["onUpdate:modelValue","id"],q=["for"],T={class:"form-group"},G=(0,t._)("label",null,"Фільм",-1),R={class:"form-main"},$=["id","value"],H=["for"],M={class:"form-group"},E=(0,t._)("h5",null,"SEO блок:",-1),K=(0,t._)("label",null,"URL",-1),L={class:"form-group"},j=(0,t._)("label",null,"Title",-1),z={class:"form-group"},O=(0,t._)("label",null,"Keywords",-1),Y={class:"form-group"},J=(0,t._)("label",null,"Description",-1),N={key:0,class:"message"},A={class:"card-footer"};function P(i,e,l,P,X,Z){return(0,t.wg)(),(0,t.iD)("div",r,[(0,t._)("div",n,[m,(0,t._)("form",{onSubmit:e[16]||(e[16]=(0,s.iM)(((...i)=>Z.updateFilm&&Z.updateFilm(...i)),["prevent"]))},[(0,t._)("div",o,[(0,t._)("div",c,[d,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"nameFilm","onUpdate:modelValue":e[0]||(e[0]=i=>X.film.nameFilm=i),required:""},null,512),[[s.nr,X.film.nameFilm]])]),(0,t._)("div",h,[g,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"Текст","onUpdate:modelValue":e[1]||(e[1]=i=>X.film.description=i),required:""},null,512),[[s.nr,X.film.description]])]),(0,t._)("div",p,[u,null===X.film.imageFirst?((0,t.wg)(),(0,t.iD)("input",{key:0,type:"file",ref:"fileInput",class:"file-input__input",onChange:e[2]||(e[2]=(...i)=>Z.handleFileChange&&Z.handleFileChange(...i)),required:""},null,544)):(0,t.kq)("",!0),null===X.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:1,onClick:e[3]||(e[3]=(...i)=>Z.triggerFileInput&&Z.triggerFileInput(...i)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",f,[(0,t._)("div",y,[X.film.imageFirst?((0,t.wg)(),(0,t.iD)("img",{key:0,src:X.film.imageFirst,class:"imgInput"},null,8,F)):(0,t.kq)("",!0)]),null!==X.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:e[4]||(e[4]=(...i)=>Z.deleteImageSrc&&Z.deleteImageSrc(...i)),class:"btn btn-block btn-default"},"Видалити")):(0,t.kq)("",!0)])]),(0,t._)("div",k,[_,(0,t._)("input",{type:"file",ref:"fileInput2",class:"file-input__input",onChange:e[5]||(e[5]=(...i)=>Z.handleFileChange2&&Z.handleFileChange2(...i)),multiple:""},null,544),X.galleryImages==[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:e[6]||(e[6]=(...i)=>Z.triggerFileInput2&&Z.triggerFileInput2(...i)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",b,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.galleryImages,((i,e)=>((0,t.wg)(),(0,t.iD)("div",{class:"image-delete",key:e},[i?((0,t.wg)(),(0,t.iD)("img",{key:0,src:i,class:"imgInput"},null,8,I)):(0,t.kq)("",!0),i?((0,t.wg)(),(0,t.iD)("span",{key:1,class:"deleteSpan",onClick:i=>Z.deleteGalleryImg(e)},"x",8,w)):(0,t.kq)("",!0)])))),128)),X.galleryImages!=[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:e[7]||(e[7]=(...i)=>Z.triggerFileInput2&&Z.triggerFileInput2(...i)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0)])]),(0,t._)("div",v,[D,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Введіть посилання на трейлер","onUpdate:modelValue":e[8]||(e[8]=i=>X.film.linkTrailer=i)},null,512),[[s.nr,X.film.linkTrailer]])]),(0,t._)("div",C,[S,(0,t._)("div",x,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.typeFilms,((i,e)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:e,onClick:l=>Z.pushTypeFilm(i,e)},[(0,t.wy)((0,t._)("input",{class:"form-check-input","onUpdate:modelValue":e=>i.checked=e,type:"checkbox",id:i.type},null,8,U),[[s.e8,i.checked]]),(0,t._)("label",{class:"form-check-label",for:i.type},(0,a.zw)(i.type),9,q)],8,V)))),128))])]),(0,t._)("div",T,[G,(0,t._)("div",R,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(X.dataFilms,((i,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:l},[(0,t.wy)((0,t._)("input",{class:"form-check-input",type:"radio",id:i.name,name:"name",value:i.name,"onUpdate:modelValue":e[9]||(e[9]=i=>X.radioData=i)},null,8,$),[[s.G2,X.radioData]]),(0,t._)("label",{class:"form-check-label",for:i.name},(0,a.zw)(i.name),9,H)])))),128))])]),(0,t._)("div",M,[E,K,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"URL","onUpdate:modelValue":e[10]||(e[10]=i=>X.film.url=i)},null,512),[[s.nr,X.film.url]])]),(0,t._)("div",L,[j,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Title","onUpdate:modelValue":e[11]||(e[11]=i=>X.film.title=i)},null,512),[[s.nr,X.film.title]])]),(0,t._)("div",z,[O,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"word","onUpdate:modelValue":e[12]||(e[12]=i=>X.film.keywords=i)},null,512),[[s.nr,X.film.keywords]])]),(0,t._)("div",Y,[J,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",placeholder:"Description","onUpdate:modelValue":e[13]||(e[13]=i=>X.film.descriptionSeo=i)},"\r\n            ",512),[[s.nr,X.film.descriptionSeo]])])]),X.showMessage?((0,t.wg)(),(0,t.iD)("div",N,(0,a.zw)(X.message),1)):(0,t.kq)("",!0),(0,t._)("div",A,[(0,t._)("button",{onClick:e[14]||(e[14]=(...i)=>Z.updateFilm&&Z.updateFilm(...i)),class:"btn btn-primary",type:"submit"},"Оновити"),(0,t._)("button",{class:"btn btn-primary",onClick:e[15]||(e[15]=(...i)=>Z.resetFilm&&Z.resetFilm(...i)),type:"button"},"Повернути базову версію")])],32)])])}var X=l(355),Z=l(650),B={data(){return{film:{},originalFilm:{},filmId:null,typeFilms:[{type:"2D",checked:!1},{type:"3D",checked:!1},{type:"IMAX",checked:!1}],dataFilms:[{name:"Вже вийшов",checked:!1},{name:"Скоро вийде",checked:!1}],fileImgSrc:null,message:"Фільм збережено!",showMessage:!1,fileGalleryImg:[],imageSrc2:null,galleryImages:[],typeFilm:[],radioData:"",loaded:!1}},async mounted(){await this.getFilm()},methods:{async getFilm(){const i=(0,X.N8)();this.filmId=this.$route.params.id;const e=(0,X.iH)(i,"films/"+this.filmId);await new Promise((i=>{(0,X.jM)(e,(e=>{e.exists()?(this.film=e.val(),this.originalFilm=e.val(),console.log(this.originalFilm),this.galleryImages=this.film.galleryImages):console.log("Фільм не знайдено"),i()}))})),this.updateChecked(),this.updateRadio()},updateChecked(){this.typeFilms.forEach((i=>{this.film.typeFilm.includes(i.type)&&(i.checked=!0,!0!==i.checked||this.typeFilm.includes(i.type)||this.typeFilm.push(i.type))}))},pushTypeFilm(i,e){this.typeFilm.includes(i.type)||!1!==i.checked?this.typeFilm.includes(i.type)&&!0===i.checked&&(this.typeFilm.forEach((function(l,t,s){i.type===l&&(e=t)})),this.typeFilm.splice(e,1)):(this.typeFilm.push(i.type),console.log(this.typeFilm))},updateRadio(){this.dataFilms.forEach((i=>{this.film.radioData.includes(i.name)&&(i.checked=!0,!0===i.checked&&(this.radioData=i.name))}))},handleFileChange(i){this.fileImgSrc=i.target.files[0],this.film.imageFirst=URL.createObjectURL(this.fileImgSrc)},triggerFileInput(){this.$refs.fileInput.click()},deleteImageSrc(){this.film.imageFirst=null},handleFileChange2(i){this.fileGalleryImg=[...i.target.files];for(let e of this.fileGalleryImg)this.imageSrc2=URL.createObjectURL(e),this.galleryImages.push(this.imageSrc2)},triggerFileInput2(){this.$refs.fileInput2.click()},deleteGalleryImg(i){this.galleryImages.splice(i,1)},updateFilm(){const i=(0,X.N8)(),e=(0,Z.cF)(),l=`films/${this.filmId}`,t=(this.filmId,(0,X.iH)(i,l));(0,X.Vx)(t,{id:t.key,nameFilm:this.film.nameFilm,description:this.film.description,linkTrailer:this.film.linkTrailer,typeFilm:this.typeFilm,radioData:this.radioData,url:this.film.url,title:this.film.title,keywords:this.film.keywords,descriptionSeo:this.film.descriptionSeo}),this.fileImgSrc?(0,X.Vx)(t,{imageFirst:this.fileImgSrc}):(0,X.Vx)(t,{imageFirst:this.film.imageFirst});const s=[];if(this.fileGalleryImg.forEach(((i,l)=>{const a=(0,Z.iH)(e,`films/${t.key}/galleryImgs/${l}`);(0,Z.KV)(a,i).then((i=>{(0,Z.Jt)(i.ref).then((i=>{s[l]=i,s.length===this.fileGalleryImg.length&&(0,X.Vx)(t,{galleryImages:s})}))}))})),this.fileImgSrc){const i=(0,Z.iH)(e,`films/${t.key}/imageFirst`);(0,Z.KV)(i,this.fileImgSrc).then((i=>{(0,Z.Jt)(i.ref).then((i=>{(0,X.Vx)(t,{imageFirst:i})}))}))}this.showMessage=!0,setTimeout((()=>{this.showMessage=!1}),3e3),this.$router.push("/films")},resetFilm(){this.film.description=this.originalFilm.description,this.film.descriptionSeo=this.originalFilm.descriptionSeo,this.film.galleryImages=this.originalFilm.galleryImages,this.film.imageFirst=this.originalFilm.imageFirst,this.film.keywords=this.originalFilm.keywords,this.film.linkTrailer=this.originalFilm.linkTrailer,this.film.nameFilm=this.originalFilm.nameFilm,this.radioData=this.originalFilm.radioData,this.film.title=this.originalFilm.title,this.typeFilms.forEach((i=>{i.checked=this.originalFilm.typeFilm.includes(i.type)})),this.film.url=this.originalFilm.url}}},Q=l(744);const W=(0,Q.Z)(B,[["render",P]]);var ii=W}}]);
//# sourceMappingURL=222.b9d9e8c9.js.map