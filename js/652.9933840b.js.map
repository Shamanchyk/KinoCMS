{"version":3,"file":"js/652.9933840b.js","mappings":"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","sources":["webpack://kinocms/./src/views/Admin/FilmsVue.vue","webpack://kinocms/./src/views/Admin/FilmsVue.vue?250e"],"sourcesContent":["<template>\r\n    <div class=\"preloader\" v-if=\"loading\">\r\n      <div class=\"loader\"></div>\r\n    </div>\r\n    <div v-if=\"loading === false\">\r\n      <div> \r\n        <h2>Список поточних фільмів</h2>\r\n        <div class=\"films-main\">\r\n            <div class=\"film-main\" v-for=\"film in films\" :key=\"film.id\">\r\n                <div class=\"image-delete\">\r\n                  <router-link :to=\"{ name: 'film', params: {id: film.id}}\">\r\n                    <img :src=\"film.image\" class=\"imgInput\" v-if=\"film.image\">\r\n                    <span class=\"deleteSpan\" v-if=\"film.image\">x</span>\r\n                  </router-link>\r\n                  \r\n                </div>\r\n                <p @click=\"filmClick(film.id)\">{{ film.title }}</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"mt\">\r\n        <h2>Список фільмів, які скоро вийдуть</h2>\r\n        <div class=\"films-main\">\r\n            <div class=\"film-main\" v-for=\"film in films2\" :key=\"film.id\">\r\n                <div class=\"image-delete\">\r\n                  <img :src=\"film.image\" class=\"imgInput\" v-if=\"film.image\" @click=\"filmClick(film.id)\">\r\n                  <span class=\"deleteSpan\" v-if=\"film.image\" @click=\"deleteFilm(film.id)\">x</span>\r\n                </div>\r\n                <p @click=\"filmClick(film.id)\">{{ film.title }}</p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    </div>\r\n    \r\n</template>\r\n\r\n\r\n<script>    \r\n\r\nimport { ref, onMounted } from 'vue';\r\nimport { getDatabase, ref as dbRef, onValue, remove } from 'firebase/database';\r\nimport { getStorage, ref as storRef, deleteObject, listAll } from \"firebase/storage\";\r\n\r\nexport default {\r\n\r\n    setup() {\r\n    const db = getDatabase()\r\n    const moviesRef = dbRef(db, 'films');\r\n\r\n    const loading = ref(true)\r\n    const films = ref([]);\r\n    const films2 = ref([]);\r\n\r\n    onMounted(() => {\r\n      onValue(moviesRef, (snapshot) => {\r\n        const moviesData = snapshot.val();\r\n        const moviesArray = [];\r\n        const moviesArray2 = [];\r\n\r\n        for (const key in moviesData) {\r\n          if(moviesData[key].radioData === 'Вже вийшов'){\r\n            moviesArray.push({\r\n              id: moviesData[key].id,\r\n              title: moviesData[key].nameFilm,\r\n              image: moviesData[key].imageFirst,\r\n            });\r\n          } else{\r\n            moviesArray2.push({\r\n              id: moviesData[key].id,\r\n              title: moviesData[key].nameFilm,\r\n              image: moviesData[key].imageFirst,\r\n            });\r\n          }\r\n          \r\n        }\r\n\r\n        films.value = moviesArray;\r\n        films2.value = moviesArray2;\r\n\r\n        setTimeout(() => {\r\n          loading.value = false;\r\n        }, 2000);\r\n      });\r\n    });\r\n    return { films, films2, loading };\r\n  },\r\n\r\n\r\n    data(){\r\n        return{\r\n\r\n        }\r\n    },\r\n\r\n    methods: {\r\n      filmClick(id) {\r\n        this.$router.push({ name: \"film\", params: { id } });\r\n      },\r\n      deleteFilm(id){\r\n        const db = getDatabase();\r\n        const pathDb = `films/${id}`\r\n        const itemRef = dbRef(db, pathDb);\r\n\r\n        remove(itemRef)\r\n          .then(() => {\r\n            console.log(\"Item successfully deleted from Realtime Database\");\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"Error deleting item from Realtime Database: \", error);\r\n          });\r\n        \r\n          const storage = getStorage();\r\n          const pathStor = `films/${id}/galleryImgs`\r\n\r\n          \r\n\r\n          // Видалення фотографій фільму\r\n           const filmPhotosRef = storRef(storage, pathStor);\r\n\r\n            listAll(filmPhotosRef).then((result) => {\r\n            result.items.forEach((imageRef) => {\r\n              // Видаляємо кожну фотографію\r\n              deleteObject(imageRef).then(() => {\r\n                console.log(`Фотографія ${imageRef.name} була успішно видалена!`);\r\n              }).catch((error) => {\r\n                console.log(`Сталася помилка при видаленні фотографії ${imageRef.name}:`, error);\r\n              });\r\n            });\r\n          });\r\n           \r\n          // // Видалення головної фотографії фільму\r\n          const filmMainPhotoRef = storRef(storage, `films/${id}/imageFirst`);\r\n          deleteObject(filmMainPhotoRef);\r\n\r\n          // Видалення папки фільму\r\n          // const filmRef = storRef(storage, `films/${id}`);\r\n          // deleteObject(filmRef);\r\n\r\n      }\r\n    },\r\n\r\n}\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n.films-main{\r\n    display: flex;\r\n    gap: 40px;\r\n    width: 92%;\r\n    margin: 30px auto 0;\r\n}\r\n.film-main{\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n    cursor: pointer;\r\n\r\n    img{\r\n        width: 250px;\r\n        height: 250px;\r\n        display: block;\r\n    }\r\n\r\n    p{\r\n        font-weight: 600;\r\n        font-size: 20px;\r\n        color: #515558;\r\n    }\r\n}\r\n.mt{\r\n  margin-top: 40px;\r\n}\r\n.deleteSpan{\r\n  position: absolute;\r\n  top: -8px;\r\n  right: -8px;\r\n  border: 1px solid black;\r\n  background: white;\r\n  border-radius: 50%;\r\n  color: black;\r\n  width: 26px;\r\n  cursor: pointer;\r\n}\r\n.image-delete{\r\n  position: relative;\r\n}\r\n    \r\n\r\n.preloader {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #333333;\r\n  opacity: 0.7;\r\n  z-index: 99999;\r\n}\r\n\r\n.loader {\r\n  border: 16px solid #333333;\r\n  border-top: 16px solid #3498db;\r\n  border-radius: 50%;\r\n  width: 120px;\r\n  height: 120px;\r\n  animation: spin 1s linear infinite;\r\n\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  margin-top: -60px;\r\n  margin-left: -60px;\r\n}\r\n@keyframes spin {\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n</style>","import { render } from \"./FilmsVue.vue?vue&type=template&id=d787ea4a\"\nimport script from \"./FilmsVue.vue?vue&type=script&lang=js\"\nexport * from \"./FilmsVue.vue?vue&type=script&lang=js\"\n\nimport \"./FilmsVue.vue?vue&type=style&index=0&id=d787ea4a&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\MrBin\\\\Desktop\\\\Front\\\\Kino_CMS\\\\kinocms\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","loading","films","film","key","id","to","src","image","filmClick","title","films2","deleteFilm","setup","db","moviesRef","snapshot","moviesData","val","moviesArray","moviesArray2","radioData","push","nameFilm","imageFirst","value","setTimeout","data","methods","this","$router","name","params","pathDb","itemRef","then","console","log","catch","error","storage","pathStor","filmPhotosRef","result","items","forEach","imageRef","filmMainPhotoRef","__exports__","render"],"sourceRoot":""}