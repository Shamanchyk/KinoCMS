"use strict";(self["webpackChunkkinocms"]=self["webpackChunkkinocms"]||[]).push([[249],{249:function(e,l,i){i.r(l),i.d(l,{default:function(){return le}});var t=i(252),s=i(963),a=i(577);const n={class:"container"},r={class:"card card-primary"},m=(0,t._)("div",{class:"card-header"},[(0,t._)("h3",{class:"card-title"},"Інформація про фільм")],-1),c={class:"card-body"},o={class:"form-group"},d=(0,t._)("label",{for:"nameFilm"},"Назва фільма",-1),g={class:"form-group"},f=(0,t._)("label",{for:"description"},"Опис",-1),u={class:"file-input"},h=(0,t._)("label",{for:"holovnaImg"},"Головна картинка",-1),p={class:"image-delete_btn"},y={class:"image-delete"},k=["src"],I={class:"file-input"},_=(0,t._)("label",{for:"holovnaImg"},"Галерея картинок",-1),b={class:"image-delete_btn2"},F=["src"],w=["onClick"],v={class:"form-group"},D=(0,t._)("label",null,"Посилання на трейлер",-1),C={class:"form-group"},S=(0,t._)("label",null,"Тип фільма",-1),x={class:"form-main"},V=["onClick"],U=["onUpdate:modelValue","id"],q=["for"],$={class:"form-group"},R=(0,t._)("label",null,"Фільм",-1),H={class:"form-main"},G=["id","value","checked"],T=["for"],M={class:"form-group"},E=(0,t._)("h5",null,"SEO блок:",-1),K=(0,t._)("label",null,"URL",-1),L={class:"form-group"},O=(0,t._)("label",null,"Title",-1),j={class:"form-group"},z=(0,t._)("label",null,"Keywords",-1),Y={class:"form-group"},J=(0,t._)("label",null,"Description",-1),N={key:0,class:"message"},A={class:"card-footer"},X=(0,t._)("button",{class:"btn btn-primary"},"Повернути базову версію",-1);function Z(e,l,i,Z,B,P){return(0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("div",r,[m,(0,t._)("form",{onSubmit:l[14]||(l[14]=(0,s.iM)(((...e)=>P.updateFilm&&P.updateFilm(...e)),["prevent"]))},[(0,t._)("div",c,[(0,t._)("div",o,[d,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",id:"nameFilm","onUpdate:modelValue":l[0]||(l[0]=e=>B.film.nameFilm=e),required:""},null,512),[[s.nr,B.film.nameFilm]])]),(0,t._)("div",g,[f,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",id:"description",placeholder:"Текст","onUpdate:modelValue":l[1]||(l[1]=e=>B.film.description=e),required:""},null,512),[[s.nr,B.film.description]])]),(0,t._)("div",u,[h,null===B.film.imageFirst?((0,t.wg)(),(0,t.iD)("input",{key:0,type:"file",ref:"fileInput",class:"file-input__input",onChange:l[2]||(l[2]=(...e)=>P.handleFileChange&&P.handleFileChange(...e)),required:""},null,544)):(0,t.kq)("",!0),null===B.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:1,onClick:l[3]||(l[3]=(...e)=>P.triggerFileInput&&P.triggerFileInput(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",p,[(0,t._)("div",y,[B.film.imageFirst?((0,t.wg)(),(0,t.iD)("img",{key:0,src:B.film.imageFirst,class:"imgInput"},null,8,k)):(0,t.kq)("",!0)]),null!==B.film.imageFirst?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[4]||(l[4]=(...e)=>P.deleteImageSrc&&P.deleteImageSrc(...e)),class:"btn btn-block btn-default"},"Видалити")):(0,t.kq)("",!0)])]),(0,t._)("div",I,[_,(0,t._)("input",{type:"file",ref:"fileInput2",class:"file-input__input",onChange:l[5]||(l[5]=(...e)=>P.handleFileChange2&&P.handleFileChange2(...e)),multiple:""},null,544),B.galleryImages==[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[6]||(l[6]=(...e)=>P.triggerFileInput2&&P.triggerFileInput2(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0),(0,t._)("div",b,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(B.galleryImages,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"image-delete",key:l},[e?((0,t.wg)(),(0,t.iD)("img",{key:0,src:e,class:"imgInput"},null,8,F)):(0,t.kq)("",!0),e?((0,t.wg)(),(0,t.iD)("span",{key:1,class:"deleteSpan",onClick:e=>P.deleteGalleryImg(l)},"x",8,w)):(0,t.kq)("",!0)])))),128)),B.galleryImages!=[]?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:l[7]||(l[7]=(...e)=>P.triggerFileInput2&&P.triggerFileInput2(...e)),class:"btn btn-block btn-default"},"Добавити")):(0,t.kq)("",!0)])]),(0,t._)("div",v,[D,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Введіть посилання на трейлер","onUpdate:modelValue":l[8]||(l[8]=e=>B.film.linkTrailer=e)},null,512),[[s.nr,B.film.linkTrailer]])]),(0,t._)("div",C,[S,(0,t._)("div",x,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(B.typeFilms,((l,i)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:i,onClick:t=>e.pushTypeFilm(l,i)},[(0,t.wy)((0,t._)("input",{class:"form-check-input","onUpdate:modelValue":e=>l.checked=e,type:"checkbox",id:l.type},null,8,U),[[s.e8,l.checked]]),(0,t._)("label",{class:"form-check-label",for:l.type},(0,a.zw)(l.type),9,q)],8,V)))),128))])]),(0,t._)("div",$,[R,(0,t._)("div",H,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(B.dataFilms,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"form-check",key:l},[(0,t._)("input",{class:"form-check-input",type:"radio",id:e.name,name:"name",value:e.name,checked:e.checked},null,8,G),(0,t._)("label",{class:"form-check-label",for:e.name},(0,a.zw)(e.name),9,T)])))),128))])]),(0,t._)("div",M,[E,K,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"URL","onUpdate:modelValue":l[9]||(l[9]=e=>B.film.url=e)},null,512),[[s.nr,B.film.url]])]),(0,t._)("div",L,[O,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"Title","onUpdate:modelValue":l[10]||(l[10]=e=>B.film.title=e)},null,512),[[s.nr,B.film.title]])]),(0,t._)("div",j,[z,(0,t.wy)((0,t._)("input",{type:"text",class:"form-control",placeholder:"word","onUpdate:modelValue":l[11]||(l[11]=e=>B.film.keywords=e)},null,512),[[s.nr,B.film.keywords]])]),(0,t._)("div",Y,[J,(0,t.wy)((0,t._)("textarea",{type:"text",class:"form-control",placeholder:"Description","onUpdate:modelValue":l[12]||(l[12]=e=>B.film.descriptionSeo=e)},"\r\n            ",512),[[s.nr,B.film.descriptionSeo]])])]),B.showMessage?((0,t.wg)(),(0,t.iD)("div",N,(0,a.zw)(B.message),1)):(0,t.kq)("",!0),(0,t._)("div",A,[(0,t._)("button",{onClick:l[13]||(l[13]=(...e)=>P.updateFilm&&P.updateFilm(...e)),class:"btn btn-primary"},"Оновити"),X])],32)])])}var B=i(355),P=i(650),Q={data(){return{film:{},filmId:null,typeFilms:[{type:"2D",checked:!1},{type:"3D",checked:!1},{type:"IMAX",checked:!1}],dataFilms:[{name:"Вже вийшов",checked:!1},{name:"Скоро вийде",checked:!1}],fileImgSrc:null,message:"Фільм збережено!",showMessage:!1,fileGalleryImg:[],imageSrc2:null,galleryImages:[]}},mounted(){this.getFilm(),this.updateChecked(),this.updateRadio()},methods:{getFilm(){const e=(0,B.N8)();this.filmId=this.$route.params.id;const l=(0,B.iH)(e,"films/"+this.filmId);(0,B.jM)(l,(e=>{if(e.exists()){this.film=e.val();const l=this.film.galleryImages;this.galleryImages=l}else console.log("Фільм не знайдено")}))},updateChecked(){this.typeFilms.forEach((e=>{this.film.typeFilm.includes(e.type)&&(e.checked=!0)}))},updateRadio(){this.dataFilms.forEach((e=>{this.film.radioData.includes(e.name)&&(e.checked=!0)}))},handleFileChange(e){this.fileImgSrc=e.target.files[0],this.film.imageFirst=URL.createObjectURL(this.fileImgSrc)},triggerFileInput(){this.$refs.fileInput.click()},deleteImageSrc(){this.film.imageFirst=null},handleFileChange2(e){this.fileGalleryImg=[...e.target.files];for(let l of this.fileGalleryImg)this.imageSrc2=URL.createObjectURL(l),this.galleryImages.push(this.imageSrc2)},triggerFileInput2(){this.$refs.fileInput2.click()},deleteGalleryImg(e){this.galleryImages.splice(e,1),console.log(this.film.galleryImages.length)},updateFilm(){const e=(0,B.N8)(),l=(0,P.cF)(),i=`films/${this.filmId}`,t=`films/${this.filmId}/galleryImgs`,s=(0,B.iH)(e,i);if((0,B.Vx)(s,{id:s.key,nameFilm:this.film.nameFilm,description:this.film.description,linkTrailer:this.film.linkTrailer,url:this.film.url,title:this.film.title,keywords:this.film.keywords,descriptionSeo:this.film.descriptionSeo}),this.fileImgSrc?(0,B.Vx)(s,{imageFirst:this.fileImgSrc}):(0,B.Vx)(s,{imageFirst:this.film.imageFirst}),this.galleryImages.length!=this.film.galleryImages.length){const i=(0,P.iH)(l,t);(0,P.aF)(i).then((e=>{e.items.forEach((e=>{(0,P.oq)(e).then((()=>{console.log(`Фотографія ${e.name} була успішно видалена!`)})).catch((l=>{console.log(`Сталася помилка при видаленні фотографії ${e.name}:`,l)}))}))}));const a=`films/${this.filmId}/galleryImages`,n=(0,B.iH)(e,a);(0,B.Od)(n).then((()=>{console.log("Item successfully deleted from Realtime Database")})).catch((e=>{console.log("Error deleting item from Realtime Database: ",e)})),(0,B.Vx)(s,{galleryImgs:this.fileGalleryImg});const r=[];this.fileGalleryImg.forEach(((e,i)=>{const t=(0,P.iH)(l,`films/${s.key}/galleryImgs/${i}`);(0,P.KV)(t,e).then((e=>{(0,P.Jt)(e.ref).then((e=>{r[i]=e,r.length===this.fileGalleryImg.length&&(0,B.Vx)(s,{galleryImages:r})}))}))}))}if(this.fileImgSrc){const e=(0,P.iH)(l,`films/${s.key}/imageFirst`);(0,P.KV)(e,this.fileImgSrc).then((e=>{(0,P.Jt)(e.ref).then((e=>{(0,B.Vx)(s,{imageFirst:e})}))}))}this.showMessage=!0,setTimeout((()=>{this.showMessage=!1}),3e3)}}},W=i(744);const ee=(0,W.Z)(Q,[["render",Z]]);var le=ee}}]);
//# sourceMappingURL=249.473bb669.js.map